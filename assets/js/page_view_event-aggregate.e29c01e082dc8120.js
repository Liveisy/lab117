"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5677],{61165:(e,t,i)=>{i.d(t,{j:()=>o});var r=i(8068),s=i(5863),n=i(4547),a=i(17587);let o=new n.x(s.w.TIME_TO_FIRST_BYTE);if(r.RI&&"undefined"!=typeof PerformanceNavigationTiming&&!r.OF&&window===window.parent)(0,a.Ck)(({value:e,attribution:t})=>{o.isValid||o.update({value:e,attrs:{navigationEntry:t.navigationEntry}})});else if(!o.isValid){let e={};for(let t in r.gm?.performance?.timing||{})e[t]=Math.max(r.gm?.performance?.timing[t]-r.WN,0);o.update({value:e.responseStart,attrs:{navigationEntry:e}})}},62517:(e,t,i)=>{i.r(t),i.d(t,{Aggregate:()=>b});var r=i(8068),s=i(50655),n=i(29452),a=i(54821),o=i(50604),f=i(56804),m=i(50772),c=i(6677),h=i(87516),u=i(98916),d=i(16266),p=i(23073),g=i(61165),l=i(40775);class T{#e;#t;#i;#r=!1;constructor(e){this.#e=e,this.processStoredDiff()}get ready(){return this.#r}get correctedOriginTime(){return this.#t}get localTimeDiff(){return this.#i}processRumRequest(e,t,i,s){if(this.processStoredDiff(),!this.#r){if(!s)throw Error("nrServerTime not found");if(this.#t=Math.floor(s-(t+(i-t)/2)),this.#i=r.WN-this.#t,isNaN(this.#t))throw Error("Failed to correct browser time to server time");this.#e?.write({serverTimeDiff:this.#i}),this.#r=!0}}convertRelativeTimestamp(e){return r.WN+e}convertAbsoluteTimestamp(e){return e-r.WN}correctAbsoluteTimestamp(e){return e-this.#i}correctRelativeTimestamp(e){return this.correctAbsoluteTimestamp(this.convertRelativeTimestamp(e))}processStoredDiff(){if(this.#r)return;let e=this.#e?.read()?.serverTimeDiff;"number"!=typeof e||isNaN(e)||(this.#i=e,this.#t=r.WN-this.#i,this.#r=!0)}}var y=i(85341),R=i(80326),v=i(2162);class b extends u.r{static featureName=o.T;constructor(e){if(super(e,o.T),this.timeToFirstByte=0,this.firstByteToWindowLoad=0,this.firstByteToDomContent=0,(0,R.i)("send-rum",(e,t)=>{this.sendRum(e,t)},this.featureName,this.ee),!(0,a.f)(e.info))return this.ee.abort(),(0,h.R)(43);e.runtime.timeKeeper=new T(e.runtime.session),r.RI?g.j.subscribe(({value:e,attrs:t})=>{let i=t.navigationEntry;this.timeToFirstByte=Math.max(e,this.timeToFirstByte),this.firstByteToWindowLoad=Math.max(Math.round(i.loadEventEnd-this.timeToFirstByte),this.firstByteToWindowLoad),this.firstByteToDomContent=Math.max(Math.round(i.domContentLoadedEventEnd-this.timeToFirstByte),this.firstByteToDomContent),this.sendRum()}):this.sendRum()}sendRum(e=this.agentRef.info.jsAttributes,t={licenseKey:this.agentRef.info.licenseKey,applicationID:this.agentRef.info.applicationID}){let i;let a=this.agentRef.info,o={};a.queueTime&&(o.qt=a.queueTime),a.applicationTime&&(o.ap=a.applicationTime),o.be=this.timeToFirstByte,o.fe=this.firstByteToWindowLoad,o.dc=this.firstByteToDomContent;let c={tt:a.ttGuid,us:a.user,ac:a.account,pr:a.product,af:(function(e){let t=[],i=(0,m.Zm)();try{Object.keys(i.initializedAgents[e].features).forEach(e=>{switch(e){case f.K7.ajax:t.push("xhr");break;case f.K7.jserrors:t.push("err");break;case f.K7.genericEvents:t.push("ins");break;case f.K7.sessionTrace:t.push("stn");break;case f.K7.softNav:case f.K7.spa:t.push("spa")}})}catch(e){}return t})(this.agentIdentifier).join(","),...o,xx:a.extra,ua:a.userAttributes,at:a.atts};if(this.agentRef.runtime.session&&(c.fsh=Number(this.agentRef.runtime.session.isNew)),"object"==typeof e&&Object.keys(e).length>0&&(i=(0,y.G)({ja:e},this.obfuscator.obfuscateString.bind(this.obfuscator),"string")),r.gm.performance){if("undefined"!=typeof PerformanceNavigationTiming){let e=r.gm?.performance?.getEntriesByType("navigation")?.[0],t={timing:(0,s.eM)(r.WN,e,{}),navigation:(0,s.si)(e,{})};c.perf=(0,n.A)(t)}else if("undefined"!=typeof PerformanceTiming){let e={timing:(0,s.eM)(r.WN,r.gm.performance.timing,{},!0),navigation:(0,s.si)(r.gm.performance.navigation,{})};c.perf=(0,n.A)(e)}}c.fp=p.J.current.value,c.fcp=d.j.current.value;let h=this.agentRef.runtime.timeKeeper;h?.ready&&(c.timestamp=Math.floor(h.correctRelativeTimestamp((0,l.t)()))),this.rumStartTime=(0,l.t)(),this.agentRef.runtime.harvester.triggerHarvestFor(this,{directSend:{targetApp:t,payload:{qs:c,body:i}},needResponse:!0,sendEmptyBody:!0})}postHarvestCleanup({status:e,responseText:t,xhr:i,targetApp:r}){let s,n;let a=(0,l.t)();try{({app:s,...n}=JSON.parse(t)),this.processEntities(s.agents,r)}catch(e){(0,h.R)(53,e)}if((0,v.A)(r,this.agentRef)){if(e>=400||0===e){(0,h.R)(18,e),this.ee.abort();return}try{if(this.agentRef.runtime.timeKeeper.processRumRequest(i,this.rumStartTime,a,s.nrServerTime),!this.agentRef.runtime.timeKeeper.ready)throw Error("TimeKeeper not ready")}catch(e){this.ee.abort(),(0,h.R)(17,e);return}Object.keys(this.agentRef.runtime.appMetadata).length||(this.agentRef.runtime.appMetadata=s),this.drain(),this.agentRef.runtime.harvester.startTimer(),(0,c.t)(n,this.agentRef)}}processEntities(e,t){e&&t&&e.forEach(e=>{let i=this.agentRef.runtime.entityManager,r=e.entityGuid;i.get(r)||((0,v.A)(t,this.agentRef)&&i.setDefaultEntity({...t,entityGuid:r}),i.set(e.entityGuid,{...t,entityGuid:r}))})}}},85341:(e,t,i)=>{i.d(t,{G:()=>function e(t,i,r="string",s=[]){return t&&"object"==typeof t&&Object.keys(t).forEach(n=>{"object"==typeof t[n]?e(t[n],i,r,s):typeof t[n]!==r||s.includes(n)||(t[n]=i(t[n]))}),t}})}}]);