"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4297],{63578:(e,t,r)=>{r.r(t),r.d(t,{Aggregate:()=>N});let n=/([a-z0-9]+)$/i;var s=/^\n+|\n+$/g,a=r(8068),i=r(56797);function o(e){if("string"!=typeof e)return"";let t=(0,i.L)(e);return t===(0,i.L)(a.m)?"<inline>":t}var c=/function (.+?)\s*\(/,u=/^\s*at (?:((?:\[object object\])?(?:[^(]*\([^)]*\))*[^()]*(?: \[as \S+\])?) )?\(?((?:file|http|https|chrome-extension):.*?)?:(\d+)(?::(\d+))?\)?\s*$/i,l=/^\s*(?:(\S*|global code)(?:\(.*?\))?@)?((?:file|http|https|chrome|safari-extension).*?):(\d+)(?::(\d+))?\s*$/i,h=/^\s*at .+ \(eval at \S+ \((?:(?:file|http|https):[^)]+)?\)(?:, [^:]*:\d+:\d+)?\)$/i,f=/^\s*at Function code \(Function code:\d+:\d+\)\s*/i;function d(e,t){var r,n,s;let a=((n=(r=t).match(l))||(n=r.match(u)),n)?{url:n[2],func:"Anonymous function"!==n[1]&&"global code"!==n[1]&&n[1]||null,line:+n[3],column:n[4]?+n[4]:null}:r.match(h)||r.match(f)||"anonymous"===r?{func:"evaluated code"}:void 0;if(!a)return e.stackLines.push(t),e;if((s=a.func)&&s.indexOf("nrWrapper")>=0&&(e.wrapperSeen=!0),!e.wrapperSeen){let r=o(a.url);r!==a.url&&(t=t.replace(a.url,r),a.url=r),e.stackLines.push(t),e.frames.push(a)}return e}function g(e){var t=c.exec(String(e.constructor));return t&&t.length>1?t[1]:"unknown"}function p(e){var t=0;if(!e||!e.length)return t;for(var r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}var m=r(80326),v=r(29452),b=r(48532),S=r(96550),I=r(56804),w=r(98916),_=r(40775),k=r(85341);let y="Rrweb",R="Security-Policy";var E=r(2162),A=r(87516);class N extends w.r{static featureName=S.T;constructor(e){super(e,S.T),this.stackReported={},this.observedAt={},this.pageviewReported={},this.bufferedErrorsUnderSpa={},this.errorOnPage=!1,this.ee.on("interactionDone",(e,t)=>this.onInteractionDone(e,t)),(0,m.i)("err",(...e)=>this.storeError(...e),this.featureName,this.ee),(0,m.i)("ierr",(...e)=>this.storeError(...e),this.featureName,this.ee),(0,m.i)("softNavFlush",(e,t,r)=>this.onSoftNavNotification(e,t,r),this.featureName,this.ee),this.harvestOpts.aggregatorTypes=["err","ierr","xhr"],this.waitForFlags(["err"]).then(([e])=>{e?this.drain():(this.blocked=!0,this.deregisterDrain())})}serializer(e){return(0,k.G)(e,this.obfuscator.obfuscateString.bind(this.obfuscator),"string")}queryStringsBuilder(e){let t={},r=(0,v.A)(this.agentRef.runtime.releaseIds);return"{}"!==r&&(t.ri=r),e?.err?.length&&(this.errorOnPage||(t.pve="1",this.errorOnPage=!0),this.agentRef.features?.[I.K7.sessionReplay]?.featAggregate?.replayIsActive()||e.err.forEach(e=>delete e.params.hasReplay)),t}buildCanonicalStackString(e){for(var t="",r=0;r<e.frames.length;r++){var s=e.frames[r],a=function(e){if(!e)return;let t=e.match(n);if(t)return t[1]}(s.func);t&&(t+="\n"),a&&(t+=a+"@"),"string"==typeof s.url&&(t+=s.url),s.line&&(t+=":"+s.line)}return t}storeError(e,t,r,n,i,c,u){let l;if(!e)return;let h=this.agentRef.runtime.entityManager.get(u);if(!h)return(0,A.R)(56,this.featureName);if(t=t||(0,_.t)(),!r&&this.agentRef.runtime.onerror&&(l=this.agentRef.runtime.onerror(e))&&!("string"==typeof l.group&&l.group.length))return;var f,m=function(e){var t,r,n=null;try{if(n=function(e){if(!e.stack)return null;var t=e.stack.split("\n").reduce(d,{frames:[],stackLines:[],wrapperSeen:!1});return t.frames.length?{mode:"stack",name:e.name||g(e),message:e.message,stackString:(function(e){var t;if(e.length>100){var r=e.length-100;t=e.slice(0,50).join("\n")+("\n< ...truncated "+r)+" lines... >\n"+e.slice(-50).join("\n")}else t=e.join("\n");return t})(t.stackLines).replace(s,""),frames:t.frames}:null}(e))return n}catch(e){}try{if(n=function(e){if(!("line"in e))return null;var t=e.name||g(e);if(!e.sourceURL)return{mode:"sourceline",name:t,message:e.message,stackString:t+": "+e.message+"\n    in evaluated code",frames:[{func:"evaluated code"}]};var r=o(e.sourceURL),n=t+": "+e.message+"\n    at "+r;return e.line&&(n+=":"+e.line,e.column&&(n+=":"+e.column)),{mode:"sourceline",name:t,message:e.message,stackString:n,frames:[{url:r,line:e.line,column:e.column}]}}(e))return n}catch(e){}try{if(n=(r=(t=e).name||g(t))?{mode:"nameonly",name:r,message:t.message,stackString:r+": "+t.message,frames:[]}:null)return n}catch(e){}return{mode:"failed",stackString:"",frames:[]}}(e);let{shouldSwallow:S,reason:w}=function(e,t,r){let n={shouldSwallow:t||!1,reason:r||"Other"},s=e.frames?.[0];if(!s||"string"!=typeof e?.message)return n;let a=s?.url?.match(/nr-(.*)-recorder.min.js/),i=s?.url?.match(/rrweb/),o=s?.url?.match(/recorder/),c=e.message.toLowerCase().match(/an attempt was made to break through the security policy of the user agent/);return a||i?(n.shouldSwallow=!0,n.reason=y,c&&(n.reason+="-"+R)):o&&c&&(n.shouldSwallow=!0,n.reason=y+"-"+R),n}(m,r,c);if(S){this.reportSupportabilityMetric("Internal/Error/"+w);return}let k={stackHash:p(this.buildCanonicalStackString(m)),exceptionClass:m.name,request_uri:a.gm?.location.pathname};m.message&&(k.message=""+m.message),l?.group&&(k.errorGroup=l.group),i&&(0,E.A)(h,this.agentRef)&&(k.hasReplay=i);var N=p("".concat(m.name,"_").concat(m.message,"_").concat(m.stackString,"_").concat(+!!k.hasReplay));this.stackReported[N]?k.browser_stack_hash=p(m.stackString):(this.stackReported[N]=!0,k.stack_trace=(f=m.stackString).length>65530?f.substr(0,65530):f,this.observedAt[N]=Math.floor(this.agentRef.runtime.timeKeeper.correctRelativeTimestamp(t))),k.releaseIds=(0,v.A)(this.agentRef.runtime.releaseIds),this.pageviewReported[N]||(k.pageview=1,this.pageviewReported[N]=!0),k.firstOccurrenceTimestamp=this.observedAt[N],k.timestamp=Math.floor(this.agentRef.runtime.timeKeeper.correctRelativeTimestamp(t));let j=["err",N,k,{time:t},n];this.shouldAllowMainAgentToCapture(u)&&(0,b.p)("trace-jserror",j,void 0,I.K7.sessionTrace,this.ee),!this.blocked&&(e?.__newrelic?.[this.agentIdentifier]&&(k._interactionId=e.__newrelic[this.agentIdentifier].interactionId,k._interactionNodeId=e.__newrelic[this.agentIdentifier].interactionNodeId),this.shouldAllowMainAgentToCapture(u)&&(this.agentRef.features?.[I.K7.softNav]?(0,b.p)("jserror",[k,t],void 0,I.K7.softNav,this.ee):(0,b.p)("spa-jserror",j,void 0,I.K7.spa,this.ee),k.browserInteractionId&&!k._softNavFinished?(this.bufferedErrorsUnderSpa[k.browserInteractionId]??=[],this.bufferedErrorsUnderSpa[k.browserInteractionId].push(j)):null!=k._interactionId?(this.bufferedErrorsUnderSpa[k._interactionId]=this.bufferedErrorsUnderSpa[k._interactionId]||[],this.bufferedErrorsUnderSpa[k._interactionId].push(j)):this.#e(j,void 0!==k.browserInteractionId,k._softNavAttributes)),u&&this.#e([...j,u],!1,k._softNavAttributes))}#e(e,t,r={}){let[n,s,a,i,o,c]=e,u={};t?(Object.entries(r).forEach(([e,t])=>h(e,t)),s+=a.browserInteractionId,delete a._softNavAttributes,delete a._softNavFinished):(Object.entries(this.agentRef.info.jsAttributes).forEach(([e,t])=>h(e,t)),delete a.browserInteractionId),o&&Object.entries(o).forEach(([e,t])=>h(e,t));let l=s+":"+p((0,v.A)(u));function h(e,t){u[e]=t&&"object"==typeof t?(0,v.A)(t):t}this.events.add([n,l,a,i,u],c)}shouldAllowMainAgentToCapture(e){return!e||this.agentRef.init.api.duplicate_registered_data}onInteractionDone(e,t){this.bufferedErrorsUnderSpa[e.id]&&!this.blocked&&(this.bufferedErrorsUnderSpa[e.id].forEach(r=>{var n={};let s=r[4];Object.entries(e.root.attrs.custom||{}).forEach(c),Object.entries(s||{}).forEach(c);var a=r[2];t&&(a.browserInteractionId=e.root.attrs.id,a._interactionNodeId&&(a.parentNodeId=a._interactionNodeId.toString())),delete a._interactionId,delete a._interactionNodeId;var i=t?r[1]+e.root.attrs.id:r[1],o=p((0,v.A)(n));function c([e,t]){n[e]=t&&"object"==typeof t?(0,v.A)(t):t}this.events.add([r[0],i+":"+o,a,r[3],n],r[5])}),delete this.bufferedErrorsUnderSpa[e.id])}onSoftNavNotification(e,t,r){this.blocked||(this.bufferedErrorsUnderSpa[e]?.forEach(e=>this.#e(e,t,r)),delete this.bufferedErrorsUnderSpa[e])}}},85341:(e,t,r)=>{r.d(t,{G:()=>function e(t,r,n="string",s=[]){return t&&"object"==typeof t&&Object.keys(t).forEach(a=>{"object"==typeof t[a]?e(t[a],r,n,s):typeof t[a]!==n||s.includes(a)||(t[a]=r(t[a]))}),t}})}}]);