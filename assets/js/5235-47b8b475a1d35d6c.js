"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5235],{14367:(e,r,i)=>{i.d(r,{q:()=>U});var t=i(70819),a=i(33244),n=i(40044),o=i(35577),d=i(62931);let s=e=>{let{tickets:r,accidents:i,dui:t}=e,a=[],n={year:new Date().getFullYear()-1,month:new Date().getMonth()+1};if(r)for(let e=0;e<r;e+=1)a.push({violation_type:d.lT.SPEEDING,violation_date_ymd:n});if(i)for(let e=0;e<i;e+=1)a.push({violation_type:d.lT.CHARGEABLEACCIDENTNOINJURY,violation_date_ymd:n});return t&&a.push({violation_type:d.lT.DRUNKDRIVINGNOINJURY,violation_date_ymd:n}),a},l=e=>{let r=[];return r.push({claims:[],type:d.Xz.PRIMARY,uuid:e.firstDriverUUID,violations:s({tickets:e.firstDriverTickets,accidents:e.firstDriverAtFault,dui:e.firstDriverDUI}),address:{street:e.streetAddress,city:e.city,county:e.county,state:e.state,zip:e.zip},age_licensed:16,education:e.firstDriverEducation,ever_suspended_revoked:e.firstDriverSuspendedRevoked,first_name:e.firstPersonFirstName,gender:e.firstDriverGender||e.gender,last_name:e.firstPersonLastName,license_status:d.uo.ACTIVE,marital_status:e.firstDriverMarriage,occupation:e.firstDriverOccupation,birth_date_ymd:{year:e.firstPersonBirthYear,month:e.firstPersonBirthMonth,day:e.firstPersonBirthDay}}),e.driverCount&&e.driverCount>=2&&r.push({claims:[],type:d.Xz.SECONDARY,uuid:e.secondDriverUUID,violations:s({tickets:e.secondDriverTickets,accidents:e.secondDriverAtFault,dui:e.secondDriverDUI}),address:{},age_licensed:16,education:e.secondDriverEducation,ever_suspended_revoked:e.secondDriverSuspendedRevoked,first_name:e.secondPersonFirstName,gender:e.secondDriverGender,last_name:e.secondPersonLastName,license_status:d.uo.ACTIVE,marital_status:"REL_SPOUSE"===e.secondDriverRelationToPrimary?d.Bk.MARRIED:e.secondDriverMarriage,occupation:e.secondDriverOccupation,relation_to_primary_driver:e.secondDriverRelationToPrimary,birth_date_ymd:{year:e.secondPersonBirthYear,month:e.secondPersonBirthMonth,day:e.secondPersonBirthDay}}),e.driverCount&&e.driverCount>=3&&r.push({claims:[],type:d.Xz.SECONDARY,uuid:e.thirdDriverUUID,violations:s({tickets:e.thirdDriverTickets,accidents:e.thirdDriverAtFault,dui:e.thirdDriverDUI}),address:{},age_licensed:16,education:e.thirdDriverEducation,ever_suspended_revoked:e.thirdDriverSuspendedRevoked,first_name:e.thirdPersonFirstName,gender:e.thirdDriverGender,last_name:e.thirdPersonLastName,license_status:d.uo.ACTIVE,marital_status:"REL_SPOUSE"===e.thirdDriverRelationToPrimary?d.Bk.MARRIED:e.thirdDriverMarriage,occupation:e.thirdDriverOccupation,relation_to_primary_driver:e.thirdDriverRelationToPrimary,birth_date_ymd:{year:e.thirdPersonBirthYear,month:e.thirdPersonBirthMonth,day:e.thirdPersonBirthDay}}),r},u=d.RQ.PRIVATEGARAGE,c=e=>{let r=[];return r.push({uuid:e.firstVehicleUUID,auto_type:d.y_.PRIMARY,address:{},coverage:e.firstVehicleCoverageType,driver_uuid:e.firstDriverUUID,make:e.firstVehicleMake,miles_per_year:e.firstVehicleMileage,model:e.firstVehicleModel,ownership:e.firstVehicleOwnership,parking:u,primary_use:e.firstVehiclePrimaryUse,submodel:e.firstVehicleTrim,year:e.firstVehicleYear}),e.addSecondVehicle&&r.push({uuid:e.secondVehicleUUID,auto_type:d.y_.SECONDARY,address:{},coverage:e.secondVehicleCoverageType,driver_uuid:e.driverCount&&e.driverCount>1?e.secondDriverUUID:e.firstDriverUUID,make:e.secondVehicleMake,miles_per_year:e.secondVehicleMileage,model:e.secondVehicleModel,ownership:e.secondVehicleOwnership,parking:u,primary_use:e.secondVehiclePrimaryUse,submodel:e.secondVehicleTrim,year:e.secondVehicleYear}),e.addThirdVehicle&&r.push({uuid:e.thirdVehicleUUID,auto_type:d.y_.SECONDARY,address:{},coverage:e.thirdVehicleCoverageType,driver_uuid:e.driverCount&&e.driverCount>2?e.thirdDriverUUID:e.firstDriverUUID,make:e.thirdVehicleMake,miles_per_year:e.thirdVehicleMileage,model:e.thirdVehicleModel,ownership:e.thirdVehicleOwnership,parking:u,primary_use:e.thirdVehiclePrimaryUse,submodel:e.thirdVehicleTrim,year:e.thirdVehicleYear}),r},v=()=>{let e=new Date,r=new Date(e.getFullYear(),e.getMonth()+1,1);return{year:r.getFullYear(),month:r.getMonth()-1,day:1}},h=()=>{let e=new Date,r=new Date(e.getFullYear(),e.getMonth()+1,1);return{year:r.getFullYear(),month:r.getMonth()+1,day:1}},_=e=>Array.isArray(e)&&0===e.length?[JSON.stringify({match_names:["noSale"],normalized_name:"noSale",type:"noSale",logo:"noSale"})]:e?null==e?void 0:e.map(e=>JSON.stringify({logo:e.logo,match_names:e.affiliationUlid?[e.affiliationUlid]:e.matchNames,normalized_name:e.normalizedName,type:e.type})):void 0;var p=i(87604),m=i(7785);let y=e=>{var r,i;let t=null===(r=(0,m.Z)(e))||void 0===r?void 0:r.uuid,{answers:a}=e,n={};return a&&(n.vertical="auto",n.aaa_membership=a.aaaMembership,n.aarp_membership=a.aarp,n.credit_rating=a.creditScore,n.sr22_required=a.firstDriverDUI,n.occupation=a.firstDriverOccupation,n.residence_ownership=a.residenceOwnership,n.street_address=a.streetAddress,n.phone=(0,p.WL)(a.phone),n.phone_opt_in_v2=a.phoneOptIn,n.email=a.email,n.email_opt_in_v2=a.emailOptIn,n.has_insurance=a.hasAutoInsurance,n.home_owner_insurance=a.bundleWithHomeInsurance,n.insurance_expiration_ymd=h(),n.life_insurance=a.lifeInsurance,n.monthly_payment=a.monthlyPayment,n.months_insured=a.monthsInsured,n.current_insurer=a.currentAutoInsurer,n.years_insured=a.yearsInsured,n.current_bi_liability=a.currentBiLiability,n.coverage_type=a.firstVehicleCoverageType,n.military_service=a.militaryService,n.prior_policy_uuid=a.policyId,n.reason_for_quote_enum=a.autoIntent,n.selected_carriers=_(a.carrierSelection),n.years_at_residence=a.yearsAtResidence,n.drivers=l(a),n.vehicles=c(a),n.disclosure_text=a.disclosure_text,n.tcpa_shown=!!a.tcpaShown,n.completed=a.completed,n.uuid=null!==(i=a.policyId)&&void 0!==i?i:t),n};var D=i(95502);let f=e=>{var r;let i=null===(r=(0,m.Z)(e))||void 0===r?void 0:r.uuid,{answers:t}=e,a=null==t?void 0:t.insured,n={};return n.vertical="home",n.uuid=null==t?void 0:t.policyId,n.bathrooms=null==t?void 0:t.bathrooms,n.bedrooms=null==t?void 0:t.bedrooms,n.current_insurer=null==t?void 0:t.currentInsurer,n.credit_rating=null==t?void 0:t.creditScore,n.email=null==t?void 0:t.email,n.first_name=null==t?void 0:t.firstPersonFirstName,n.gender=null==t?void 0:t.gender,n.insured=null==t?void 0:t.insured,n.insurance_expiration_ymd=a?h():{},n.new_purchase=!a,n.last_name=null==t?void 0:t.firstPersonLastName,n.military_service=null==t?void 0:t.militaryService,n.phone=(0,p.WL)(null==t?void 0:t.phone),n.previous_claim=null==t?void 0:t.previousClaim,(null==t?void 0:t.previousClaim)&&(n.previous_claim_type=D.gb.WEATHER,n.previous_claim_date_ymd=v()),n.property_type=null==t?void 0:t.propertyType,n.occupancy=null==t?void 0:t.propertyPrimaryUse,n.roof_type=null==t?void 0:t.roofType,n.square_feet=null==t?void 0:t.squareFootage,n.year_built=null==t?void 0:t.decadeBuilt,n.completed=null==t?void 0:t.completed,n.address={street:null==t?void 0:t.streetAddress,city:null==t?void 0:t.city,county:null==t?void 0:t.county,state:null==t?void 0:t.state,zip:null==t?void 0:t.zip},n.selected_carriers=_(t.carrierSelection),(null==t?void 0:t.firstPersonBirthYear)&&(n.birth_date_ymd={year:null==t?void 0:t.firstPersonBirthYear,month:null==t?void 0:t.firstPersonBirthMonth,day:null==t?void 0:t.firstPersonBirthDay}),n.disclosure_text=null==t?void 0:t.disclosure_text,n.tcpa_shown=!!t.tcpaShown,n.completed=null==t?void 0:t.completed,n.uuid=(null==t?void 0:t.policyId)||i,n};var g=i(92111),I=i(28141);let P=(e,r)=>{switch(e){case"home":return f(r);case"auto":return y(r);default:return{}}},U=async e=>{var r,i,d,s;let{arrival:l,answers:u}=e,c=!!(null==u?void 0:u.landingSubmitted),v=null!==(d=null==l?void 0:null===(r=l.attributes)||void 0===r?void 0:r.vertical)&&void 0!==d?d:"auto",h=P(v,e),_=(0,o.Ay)({arrival:l,policy:h}),{attributes:{domain:p,jwt:m,visitorUUID:y}}=l,D={arrival:_,auth_token:m,landing_submitted:c,source:"marketplace-ui",visitor:{domain:p,uuid:y}},f=(0,g.o)()?window.location.pathname:"server";t.t.debug("updating arrival",{arrivalId:l.uuid,arrival:D,location:f});let U=await fetch("".concat(I.pn,"/api/arrivals"),{body:JSON.stringify(D),headers:{"Content-Type":"application/json"},credentials:"same-origin",method:"POST"});return(0,n._)(a.K.OcelotArrivalRequest,+(null!=U&&!!U.ok),{Vertical:v,Brand:null!==(s=null===(i=e.attributes)||void 0===i?void 0:i.brand)&&void 0!==s?s:"marketplace"}),U.ok||t.t.error("Ocelot request failed",{arrivalId:l.uuid,...D,resp:await U.text()}),U}},54893:(e,r,i)=>{i.d(r,{q:()=>n});var t=i(84202),a=i(10038);let n=async e=>{let r=e||a.B.getState().session;return(0,t.R)(r)}},85109:(e,r,i)=>{i.d(r,{w:()=>n});var t=i(10038),a=i(54893);let n=e=>{var r,i;let{session:n,setSession:o,sessionInitialised:d,setSessionInitialised:s}=(0,t.B)(e=>e),l=null==n?void 0:null===(r=n.arrival)||void 0===r?void 0:r.uuid,u=null==e?void 0:null===(i=e.arrival)||void 0===i?void 0:i.uuid;return e&&(!d||l!==u)?(o(e),s(!0),(0,a.q)(e),e):n}}}]);