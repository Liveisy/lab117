"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9100],{54435:(e,t,i)=>{i.r(t),i.d(t,{Aggregate:()=>y});var s=i(80326),r=i(87516),n=i(29452),a=i(98916),o=i(98183),g=i(8068),h=i(56797);class l{timestamp;message;attributes;level;constructor(e,t,i={},s=o.p_.INFO){this.timestamp=e,this.message=t,this.attributes={...i,pageUrl:(0,h.L)(""+g.m)},this.level=s.toUpperCase()}}var p=i(72421),u=i(85341),d=i(11297),c=i(2162),f=i(26196),b=i(4700),m=i(95829);class y extends a.r{static featureName=o.TZ;constructor(e){super(e,o.TZ),this.isSessionTrackingEnabled=(0,m.V)(e.init)&&e.runtime.session,this.ee.on(f.tS.RESET,()=>{this.abort(b.bc.RESET)}),this.ee.on(f.tS.UPDATE,(e,t)=>{this.blocked||e!==f.iL.CROSS_TAB||(this.loggingMode!==o.A$.OFF&&t.loggingMode===o.A$.OFF?this.abort(b.bc.CROSS_TAB):this.loggingMode=t.loggingMode)}),this.harvestOpts.raw=!0,this.waitForFlags(["log"]).then(([t])=>{let i=this.agentRef.runtime.session??{};if(this.loggingMode===o.A$.OFF||i.isNew&&t===o.A$.OFF){this.blocked=!0,this.deregisterDrain();return}i.isNew||!this.isSessionTrackingEnabled?this.updateLoggingMode(t):this.loggingMode=i.state.loggingMode,(0,s.i)(o.ET,this.handleLog.bind(this),this.featureName,this.ee),this.drain(),e.runtime.harvester.triggerHarvestFor(this)})}updateLoggingMode(e){this.loggingMode=e,this.syncWithSessionManager({loggingMode:this.loggingMode})}handleLog(e,t,i={},s=o.p_.INFO,a){if(!this.agentRef.runtime.entityManager.get(a))return(0,r.R)(56,this.featureName);if(this.blocked||!this.loggingMode)return;if(i&&"object"==typeof i||(i={}),"string"==typeof s&&(s=s.toUpperCase()),!(0,p.b)(s))return(0,r.R)(30,s);if(this.loggingMode<(o.A$[s]||1/0)){this.reportSupportabilityMetric("Logging/Event/Dropped/Sampling");return}try{if("string"!=typeof t){let e=(0,n.A)(t);t=e&&"{}"!==e?e:String(t)}}catch(e){(0,r.R)(16,t),this.reportSupportabilityMetric("Logging/Event/Dropped/Casting");return}if("string"!=typeof t||!t)return(0,r.R)(32);let g=new l(Math.floor(this.agentRef.runtime.timeKeeper.correctRelativeTimestamp(e)),t,i,s),h=g.message.length+(0,n.A)(g.attributes).length+g.level.length+10,u="Logging/Harvest/Failed/Seen";if(h>d.It){this.reportSupportabilityMetric(u,h),(0,r.R)(31,g.message.slice(0,25)+"...");return}this.events.wouldExceedMaxSize(h,a)&&(this.reportSupportabilityMetric("Logging/Harvest/Early/Seen",this.events.byteSize()+h),this.agentRef.runtime.harvester.triggerHarvestFor(this,{targetEntityGuid:a})),this.events.add(g,a)?this.reportSupportabilityMetric("Logging/Event/Added/Seen"):(this.reportSupportabilityMetric(u,h),(0,r.R)(31,g.message.slice(0,25)+"..."))}serializer(e,t){let i=this.agentRef.runtime.entityManager.get(t),s=this.agentRef.runtime.session;return[{common:{attributes:{"entity.guid":i.entityGuid,...s&&{session:s.state.value||"0",hasReplay:1===s.state.sessionReplayMode&&(0,c.A)(i,this.agentRef),hasTrace:1===s.state.sessionTraceMode},ptid:this.agentRef.runtime.ptid,appId:i.applicationID||this.agentRef.info.applicationID,standalone:!!this.agentRef.info.sa,agentVersion:this.agentRef.runtime.version,"instrumentation.provider":"browser","instrumentation.version":this.agentRef.runtime.version,"instrumentation.name":this.agentRef.runtime.loaderType,...this.agentRef.info.jsAttributes}},logs:(0,u.G)(e,this.obfuscator.obfuscateString.bind(this.obfuscator),"string")}]}queryStringsBuilder(e,t){return{browser_monitoring_key:this.agentRef.runtime.entityManager.get(t).licenseKey}}abort(e={}){this.reportSupportabilityMetric("Logging/Abort/".concat(e.sm)),this.blocked=!0,this.events&&(this.events.clear(),this.events.clearSave()),this.updateLoggingMode(o.A$.OFF),this.deregisterDrain()}syncWithSessionManager(e={}){this.isSessionTrackingEnabled&&this.agentRef.runtime.session.write(e)}}},85341:(e,t,i)=>{i.d(t,{G:()=>function e(t,i,s="string",r=[]){return t&&"object"==typeof t&&Object.keys(t).forEach(n=>{"object"==typeof t[n]?e(t[n],i,s,r):typeof t[n]!==s||r.includes(n)||(t[n]=i(t[n]))}),t}})}}]);